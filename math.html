<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>문제집 추천 알고리즘</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse {
      0%,100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    body {
      margin: 0;
      height: 100vh;
      font-family: 'Noto Sans KR', sans-serif;
      background: radial-gradient(ellipse at top right, #1a1c2e, #0a0b12);
      color: #f2f4f7;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    .chat-container {
      width: 400px;
      min-height: 600px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 20px;
      backdrop-filter: blur(15px);
      box-shadow: 0 0 25px rgba(0,0,0,0.4);
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      animation: fadeIn 0.6s ease;
    }

    .title {
      text-align: center;
      font-size: 1.5rem;
      font-weight: 700;
      color: #fff;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }

    .display-area {
      flex: 1;
      overflow-y: auto;
      padding: 10px;
      margin-bottom: 10px;
    }

    .message {
      background: linear-gradient(135deg, #3a3f74, #1f233b);
      border-radius: 12px;
      padding: 12px 16px;
      margin-bottom: 8px;
      animation: fadeIn 0.3s ease;
    }

    .options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      animation: fadeIn 0.4s ease;
    }

    button {
      background: linear-gradient(135deg, #5b78f6, #3ad1ff);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 10px 18px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    button:hover {
      transform: scale(1.08);
      box-shadow: 0 0 10px rgba(91,120,246,0.6);
    }
    .footer-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    .footer-buttons button {
      flex: 1;
      margin: 0 5px;
      font-size: 0.85rem;
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.2);
    }
    .footer-buttons button:hover {
      background: rgba(255,255,255,0.3);
    }
  </style>
</head>
<body>
  <div class="chat-container">
    <div class="title">문제집 추천 알고리즘 🚀</div>
    <div id="display" class="display-area"></div>
    <div class="options" id="options"></div>
    <div class="footer-buttons">
      <button id="backBtn">⬅️ 뒤로가기</button>
      <button id="restartBtn">🔁 처음으로</button>
    </div>
  </div>

  <script>
    const bookData = {
      "개념서": {
        1: ["수학의 바이블", "마플 교과서", "수학의 왕도", "올림포스 수학", "개념 플러스 유형 고등 수학", "이유있는 수학 개념 SOS", "셀파 해법수학"],
        2: ["수학의 샘", "개념 쎈", "풍산자", "개념원리"],
        3: ["기본 수학의 정석", "수학중심 고등수학", "메가스터디 문제 기본서 CPR수학", "더 개념 블랙라벨"],
        4: ["실력 수학의 정석", "숨마쿰라우데"]
      },
      "유형·심화서": {
        1: ["수력충전", "수학의 바이블 BOB", "개념 플러스 유형 라이트", "라이트 쎈", "유형 해결의 법칙", "올림포스 닥터링"],
        2: ["개념원리 RPM", "풍산자 필수유형", "내공의 힘", "올리드", "하이라이트 단기 특강", "심플 자이스토리"],
        3: ["쎈 수학", "마플 시너지", "일등급 수학", "1등급 만들기"],
        4: ["일품", "올림포스 고난도", "수능다큐", "절대등급", "유형+내신 고쟁이", "블랙라벨", "내신 하이앤드", "현우진 뉴런-시냅스", "수학의 신"],
        5: ["TOT", "531 하이퍼", "절대등급 코드엠", "현우진 드릴"]
      },
      "기출": [
        "자이스토리", "짱 어려운 유형 고난도 4점짜리 수학", "너희들의 기출문제", "마플 수능기출총정리", "수능 기출의 바이블",
        "실전+수능 고쟁이", "어삼쉬사", "너기출", "수능 기출의 미래", "쎈 기출", "티오피 클래스 수능 기출문제집",
        "이동훈 기출문제집", "담금질", "백미", "기출의 고백", "마더텅", "올림포스 기출문제집"
      ]
    };

    const display = document.getElementById("display");
    const options = document.getElementById("options");
    const backBtn = document.getElementById("backBtn");
    const restartBtn = document.getElementById("restartBtn");

    let history = [];
    let step = "start";
    let selectedType = null;
    let selectedLevel = null;

    function showMessage(text) {
      const msg = document.createElement("div");
      msg.classList.add("message");
      msg.textContent = text;
      display.appendChild(msg);
      display.scrollTop = display.scrollHeight;
    }

    function setOptions(arr, callback) {
      options.innerHTML = "";
      arr.forEach(opt => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => {
          history.push({ step, selectedType, selectedLevel });
          callback(opt);
        };
        options.appendChild(btn);
      });
    }

    function goBack() {
      if (history.length === 0) return;
      const last = history.pop();
      step = last.step;
      selectedType = last.selectedType;
      selectedLevel = last.selectedLevel;
      options.innerHTML = "";
      if (step === "start") startChat();
      else if (step === "type") chooseType();
      else if (step === "level") chooseLevel(selectedType);
    }

    function restart() {
      display.innerHTML = "";
      options.innerHTML = "";
      history = [];
      step = "start";
      selectedType = null;
      selectedLevel = null;
      startChat();
    }

    function startChat() {
      showMessage("안녕하세요 👋 문제집 추천 알고리즘입니다.");
      showMessage("어떤 종류의 문제집을 찾고 계신가요?");
      step = "type";
      setOptions(["개념서", "유형·심화서", "기출"], (type) => {
        selectedType = type;
        if (type === "기출") recommend();
        else chooseLevel(type);
      });
    }

    function chooseLevel(type) {
      let maxLevel = type === "개념서" ? 4 : 5;
      showMessage(`${type}의 난이도를 선택해주세요 (1~${maxLevel})`);
      step = "level";
      const range = Array.from({ length: maxLevel }, (_, i) => (i + 1).toString());
      setOptions(range, (lvl) => {
        selectedLevel = parseInt(lvl);
        recommend();
      });
    }

    function recommend() {
      options.innerHTML = "";
      let result = [];
      if (selectedType === "기출") {
        result = bookData["기출"];
        showMessage("🔍 추천 기출 문제집:");
      } else {
        const data = bookData[selectedType][selectedLevel];
        result = data || [];
        showMessage(`📘 추천 ${selectedType} (${selectedLevel}단계):`);
      }
      if (result.length > 0) {
        result.forEach(name => showMessage("• " + name));
      } else {
        showMessage("😥 해당 조건에 맞는 문제집이 없습니다.");
      }
      showMessage("✅ 추천이 완료되었습니다.");
    }

    backBtn.onclick = goBack;
    restartBtn.onclick = restart;

    startChat();
  </script>
</body>
</html>
